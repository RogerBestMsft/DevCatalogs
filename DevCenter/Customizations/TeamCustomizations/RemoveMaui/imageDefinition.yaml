$schema: "1.0"
name: "remove-maui-workloads"
image: microsoftvisualstudio_visualstudioplustools_vs-2022-ent-general-win11-m365-gen2
tasks:
  - name: powershell
    description: Identify and remove all MAUI workloads using Visual Studio Installer CLI
    parameters:
      command: |
        # PowerShell script to uninstall VSIX extensions only present in vsix_product_ids1.txt
        $vsixInstaller = "C:\Program Files\Microsoft Visual Studio\2022\Enterprise\Common7\IDE\VSIXInstaller.exe"

        # Uninstalling Xamarin.VisualStudio.Android.Deploy
        & $vsixInstaller /uninstall:Xamarin.VisualStudio.Android.Deploy /quiet

        # Uninstalling Xamarin.VisualStudio.Android.Designer
        & $vsixInstaller /uninstall:Xamarin.VisualStudio.Android.Designer /quiet

        # Uninstalling Xamarin.VisualStudio.Designer
        & $vsixInstaller /uninstall:Xamarin.VisualStudio.Designer /quiet

        # Uninstalling Xamarin.VisualStudio.Forms.Editor
        & $vsixInstaller /uninstall:Xamarin.VisualStudio.Forms.Editor /quiet

        # Uninstalling Xamarin.HotReload.Vsix.f135f3c0-16d7-4349-908e-2b35db4a8ff2
        & $vsixInstaller /uninstall:Xamarin.HotReload.Vsix.f135f3c0-16d7-4349-908e-2b35db4a8ff2 /quiet

        # Uninstalling Mono.Debugging.VisualStudio
        & $vsixInstaller /uninstall:Mono.Debugging.VisualStudio /quiet

        # Uninstalling Xamarin.Android.Sdk
        & $vsixInstaller /uninstall:Xamarin.Android.Sdk /quiet

        # Uninstalling Xamarin.VisualStudio
        & $vsixInstaller /uninstall:Xamarin.VisualStudio /quiet
